// ===============================
// Tour Virtual Guatap√© 360¬∞
// ===============================

function mostrarEscena(id) {
  const escena = window.TOUR_DATA.escenas.find(e => e.id === id);
  if (!escena) return;

  // üé• Cargar video principal
  const video360 = document.querySelector("#video360");
  video360.setAttribute("src", escena.archivo);

  // üé¨ Cargar video lateral
  const videoLateral = document.querySelector("#videoLateral");
  if (escena.lateralVideo) {
    videoLateral.setAttribute("src", escena.lateralVideo);
    document.getElementById("videoLateralContainer").style.display = "block";
  } else {
    document.getElementById("videoLateralContainer").style.display = "none";
  }

  // üßπ Eliminar hotspots anteriores
  document.querySelectorAll(".hotspot").forEach(h => h.remove());

  // üü° Crear nuevos hotspots
  if (escena.hotspots) {
    escena.hotspots.forEach(hs => {
      const hotspot = document.createElement("a-entity");
      hotspot.setAttribute("geometry", "primitive: sphere; radius: 0.05");
      hotspot.setAttribute("material", "color: #ffd166; shader: flat");
      hotspot.setAttribute("position", hs.posicion);
      hotspot.classList.add("hotspot");

      hotspot.addEventListener("click", () => {
        mostrarInfo(hs.titulo, hs.texto);
      });

      document.querySelector("a-scene").appendChild(hotspot);
    });
  }

  console.log(`üé¨ Mostrando escena: ${escena.nombre}`);
}

// ===============================
// Mostrar informaci√≥n al hacer clic
// ===============================
function mostrarInfo(titulo, texto) {
  const panel = document.getElementById("infoPanel");
  const tituloEl = document.getElementById("infoTitulo");
  const textoEl = document.getElementById("infoTexto");

  tituloEl.textContent = titulo;
  textoEl.textContent = texto;
  panel.style.display = "block";
}

function cerrarInfo() {
  document.getElementById("infoPanel").style.display = "none";
}

// ===============================
// Iniciar la escena al cargar
// ===============================
window.addEventListener("DOMContentLoaded", () => {
  if (window.TOUR_DATA?.escenas?.length) {
    mostrarEscena(window.TOUR_DATA.escenas[0].id);
  } else {
    console.error("‚ùå No se encontr√≥ ninguna escena en data.js");
  }
});

